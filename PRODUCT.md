# 🍉 西瓜时钟 — 产品文档

## 产品定位
简洁优雅的专注计时器，基于番茄工作法，融入西瓜种植养成元素。

## 线上地址
- **产品：** https://clock.cosmelon.app
- **管理后台：** https://admin.cosmelon.app
- **GitHub：** https://github.com/ycz87/cosmelon

## 技术架构
- **前端：** React 19 + Vite 7 + Tailwind CSS 4 + TypeScript（当前 v0.31.0）
- **后端：** Cloudflare Workers（Hono）+ D1 数据库
- **认证：** auth.cosmelon.app（邮箱验证码 + Google/Microsoft OAuth）
- **API：** api.clock.cosmelon.app
- **部署：** Cloudflare Pages + GitHub Actions CI/CD
- **移动端：** Capacitor 安卓 APK

## 核心功能模块

### 专注计时
- 番茄工作法：专注 → 休息循环
- 项目计时模式：多子任务按顺序执行
- 灵活时长（1-120 分钟）+ 快速调时间
- 正计时/倒计时切换
- 长按确认操作 + 退出确认
- 最后冲刺三级提示

### 仓库与合成
- 专注完成获得收获物（5 种生长阶段 + 金西瓜）
- 合成系统：低阶合成高阶
- **瓜棚双 Tab 布局**：🍉 瓜棚（收获物 + 合成 + 切瓜）/ 🎒 背包（种子 + 道具）
- 切瓜操作
- 道具收集

### 农场（进行中）
- 俯视微倾斜 3×3 瓜田（CSS Grid + perspective rotateX 伪 3D）
- 9 块地块：4 块已开发 + 5 块锁定（LockedPlotCard）
- 地块比例 3:4，圆角矩形，手机端一屏显示
- 种植、收获、品种收集
- 品种揭晓 Overlay（rare+ 稀有度强化特效）
- 收获 Overlay 区分新品种/重复品种反馈
- 基因片段系统：收获品种获得基因片段，实验室 tab 按星系分组查看背包
- 基因注入系统：将基因片段+种子注入，定向培育目标星系品种，种植弹窗支持注入种子选项
- 双元素融合系统：不同星系基因融合产出杂交种子，5档成功率表，基因改造液+20%加成
- 杂交图鉴页面：30个杂交品种按10个星系组合分组展示
- 变异系统：发芽期自然变异（2%），结果 40% 良性 / 30% 恶性 / 30% 无效果
- 恶性变异结果：50% 枯萎 / 50% 品质降级
- 变异射线枪：单株每次 +20% 变异概率，5 次封顶 100%
- 外星人到访、瓜贼防御（后续）
- 28 个品种图鉴

### 商城系统 🏪
- 第四主模块（顶栏新增 `🏪 商城` Tab）
- 瓜币余额系统：localStorage 持久化，顶部实时展示余额
- 买/卖双 Tab：买入（道具 + 地块扩展）+ 卖出
- 买道具：14 种常驻商品，购买后即时入库到背包
- 购买确认弹窗：展示商品名/价格/当前余额
- 地块购买区：支持购买第 5-9 块地（200/500/1000/2000/5000 瓜币）
- 已解锁地块状态：显示 `✅ 已解锁`，不可重复购买
- 卖瓜流程：确认弹窗 → 图鉴 count-1 → 瓜币增加对应售价
- 变异体交易：带 `isMutant` 标记的变异体按原品种 3 倍售价卖出
- 图鉴保留策略：卖到 0 仍保留已解锁品种记录
- 首次收获新品种奖励等额售价瓜币
- 全量售价配置：40 个纯种 + 30 个杂交（共 70 个品种）

### 成就徽章 🏆
- 44 个成就，5 个系列：⭐️坚持(10) / ⏱️专注(10) / 🏠瓜棚(10) / 🌱农场(8) / 🌟隐藏(6)
- 真实 PNG 徽章图片（AI 生成 512×512）
- 已解锁彩色 / 未解锁灰色轮廓 / 隐藏❓
- 解锁庆祝动画（灰→彩色 + 光波 + 金色粒子）
- 云端同步

### 用户系统
- 邮箱验证码登录 + Google/Microsoft OAuth
- 个人资料（头像 + 昵称）
- 云端数据同步（设置/记录/仓库/成就）
- Turnstile 防机器人

### 多语言
- 8 种语言：中文、英文、日文、韩文、法文、德文、西班牙文、葡萄牙文
- 自动检测浏览器语言

### 视听体验
- 5 套主题（含深色/浅色）
- 自定义音效混音器（背景音 + 提醒音 + 时钟音）
- 6 阶段庆祝动画
- 智能鼓励文案
- 健康提醒 Toast

### 管理后台
- 用户搜索与管理
- 角色权限控制

## 当前版本
v0.31.0（2026-02-19）

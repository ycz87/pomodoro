# 🚀 农场系统开发计划

> 版本：v1.0 | 日期：2026-02-17
> 状态：待 Charles 确认
> 关联文档：[农场设计](FARM-DESIGN-v3.md) · [商城设计](MARKET-DESIGN-v1.md) · [百科全书](ENCYCLOPEDIA-v1.md)

---

## 总览

农场系统从 Phase 1（已完成）到完整上线，分为 6 个阶段。每个阶段独立可发布，用户每个阶段都能体验到完整的新功能。

**已有基础（Phase 1 ✅）：**
- 4 块地 + 种植 + 生长 + 收获
- 厚土星 8 个品种
- 基础图鉴页面

---

## Phase 2：生长机制升级 + 多星系

**目标：** 把农场从"玩具"变成"有深度的系统"。用户能感受到专注加速的价值，能解锁新星系。

**开发内容：**

1. 生长机制重构
   - 离线时间推进（取代活跃天数）
   - 专注加速（≤2h 10倍，>2h 20倍）
   - 枯萎机制（纯种72h / 杂交96h / 幻彩只暂停）
   - 成熟时间：纯种10000min / 双元素20000min / 幻彩50000min

2. 四大星系上线（烈火/寒水/青木/玄金各8品种）
   - 品种数据录入（32个新品种）
   - 品种图片资源
   - 星系解锁逻辑

3. 图鉴升级
   - 星系分页展示
   - 未解锁星系锁定状态
   - 品种详情页（故事、首次获得日期、累计收获）
   - 进度追踪面板（"星际旅程"）

4. 地块扩展
   - 里程碑解锁（3/5/8/15/22品种）
   - 首次收获奖励（等额瓜币）

**验收标准：**
- [ ] 离线12小时回来，西瓜推进了720分钟
- [ ] 专注25分钟后，西瓜额外推进了250分钟（10倍）
- [ ] 超过72小时不开app，纯种枯萎
- [ ] 集齐厚土星5品种后烈火星解锁
- [ ] 图鉴进度面板正确显示当前进度
- [ ] 首次收获新品种获得额外瓜币

**预估工期：** 5-7 天

---

## Phase 3：基因实验室 + 杂交系统

**目标：** 给用户"第二条路径"——不只是开盲盒，还能策略性地培育想要的品种。

**开发内容：**

1. 基因片段系统
   - 收获时自动获得基因片段
   - 基因背包（按星系分类）
   - 基因属性（星系、来源品种、稀有度）

2. 基因实验室 UI（农场第三个 tab）
   - 操作一：基因注入（种子+基因→注入种子，80%定向）
   - 操作二：双元素融合（两个不同星系基因→杂交种子）
   - 融合成功率表（⭐×⭐ 30% ~ ⭐⭐⭐⭐×任意 90%）
   - 失败动画 + 成功动画

3. 杂交品种上线（30个品种）
   - 10组合 × 3品种（⭐60%/⭐⭐30%/⭐⭐⭐10%）
   - 品种数据 + 图片资源
   - 杂交图鉴独立页面

4. 注入种子逻辑
   - 80%目标星系 / 20%其他已解锁星系
   - 不会出杂交品种

**验收标准：**
- [ ] 收获品种后背包里出现对应基因片段
- [ ] 基因注入后种子标记为"注入种子"，种下后80%出目标星系
- [ ] 两个不同星系基因融合，按成功率表判定
- [ ] 融合失败消耗基因不产出种子
- [ ] 基因改造液使用后成功率+20%
- [ ] 杂交种子种下后从3个品种里按掉率随机

**预估工期：** 5-7 天

---

## Phase 4：星际商城 + 瓜币经济

**目标：** 让每颗瓜都有经济价值，让"多余资源"有出路。

**开发内容：**

1. 瓜币系统
   - 瓜币余额存储（本地 + 云端同步）
   - 首次收获奖励发放

2. 商城 UI（独立模块，与番茄钟/瓜棚/农场并列）
   - 买 tab：常驻商品14种
   - 卖 tab：背包品种瓜列表
   - 确认弹窗 + 购买/卖出动画
   - 余额不足置灰提示

3. 地块购买
   - 商城内购买地块（200/500/1000/2000/5000瓜币）
   - 与里程碑解锁取先到的

4. 道具系统完善
   - 瓜田道具快捷栏
   - 所有14种道具的使用逻辑
   - 道具效果叠加计算

**验收标准：**
- [ ] 卖瓜后瓜币增加，品种实体-1，图鉴记录保留
- [ ] 购买道具后瓜币减少，道具出现在背包
- [ ] 余额不足时无法购买
- [ ] 地块购买后立即可用
- [ ] 道具快捷栏在瓜田正常显示和使用

**预估工期：** 4-5 天

---

## Phase 5：变异 + 防护 + 星际大盗

**目标：** 增加风险与惊喜，让农场"活"起来。

**开发内容：**

1. 变异系统
   - 自然变异2%基础概率（发芽期判定）
   - 变异射线枪：单株+20%，可累加至100%
   - 变异结果三选一（40%良性/30%恶性/30%无效）
   - 变异体图鉴标记（品种名·变异名）
   - 变异体售价3倍

2. 星际大盗
   - 出现概率（按专注时长递减）
   - 30分钟倒计时偷瓜
   - 追回机制（24h内专注25min追回50%）
   - 欠条趣味展示

3. 防护道具
   - 瓜瓜星人捕网（被动抓获）
   - 瓜农守护结界（全田当天免疫）
   - 星际追踪器（单株防偷追回）
   - 琼浆玉露（复活枯萎）

4. 月神甘露
   - 稀有度+1级逻辑
   - 对⭐⭐⭐⭐无效保护

**验收标准：**
- [ ] 变异射线枪使用5次后该株100%触发变异
- [ ] 良性变异产出变异体，图鉴正确记录
- [ ] 恶性变异50%概率枯萎
- [ ] 星际大盗按概率出现，30分钟后偷瓜
- [ ] 追踪器生效时被偷自动追回
- [ ] 琼浆玉露复活枯萎西瓜，进度保留
- [ ] 月神甘露对传说品种不消耗

**预估工期：** 5-6 天

---

## Phase 6：幻彩星 + 暗物质星 + 生命感

**目标：** 终极内容上线，完成整个西瓜宇宙。

**开发内容：**

1. 五行融合
   - 五行共鸣条件判定
   - "五行融合"一键按钮
   - 成功率50% + 稀有度加成
   - 失败返还1份随机基因
   - 幻彩品种保底（重复3次后必出新品种）

2. 幻彩星（5品种）
   - 品种数据 + 图片
   - 幻彩种子种植 + 50000min成熟
   - 幻彩不枯萎只暂停（进度倒退5%/天，最多50%）

3. 暗物质星（3品种）
   - 虚空瓜：5颗幻彩基因融合
   - 黑洞瓜：10种双元素基因融合
   - 宇宙之心：全收集自动出现 + 终极动画
   - 获取指引UI

4. 天气 & 生命感
   - 天气系统（☀️☁️🌧️🌙🌈随机）
   - 小动物装饰（🐝🦋🐞🐦偶尔出现）
   - 外星人系统（瓜瓜星人/变异博士）

5. 每周刷新商城
   - 特殊货架（3-5件随机）
   - 稀有基因片段 / 传说种子 / 限定装饰

**验收标准：**
- [ ] 五行共鸣条件达成后"五行融合"按钮出现
- [ ] 幻彩种子种下后正确生长，不枯萎只暂停
- [ ] 保底机制：同品种重复3次后必出新品种
- [ ] 集齐所有品种后宇宙之心自动出现
- [ ] 天气随机切换，小动物偶尔出现
- [ ] 每周一商城特殊货架刷新

**预估工期：** 7-10 天

---

## 总工期估算

| Phase | 内容 | 工期 | 累计 |
|-------|------|------|------|
| Phase 1 ✅ | 瓜田 MVP | 已完成 | — |
| Phase 2 | 生长机制 + 多星系 | 5-7天 | 1周 |
| Phase 3 | 基因实验室 + 杂交 | 5-7天 | 2周 |
| Phase 4 | 星际商城 + 瓜币 | 4-5天 | 3周 |
| Phase 5 | 变异 + 防护 + 大盗 | 5-6天 | 4周 |
| Phase 6 | 幻彩 + 暗物质 + 生命感 | 7-10天 | 5-6周 |

**总计：约 5-6 周完成全部农场系统。**

---

## 开发原则

1. 每个 Phase 独立可发布，不依赖后续 Phase
2. 每个 Phase 完成后 bump 版本号 + 更新四个文档
3. 先做核心逻辑，再做动画和视觉打磨
4. 数据结构要为后续 Phase 预留扩展性
5. 云端同步接口每个 Phase 同步更新
